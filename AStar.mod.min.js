// (C) Andrea Giammarchi
//	Special thanks to Alessandro Crugnola [www.sephiroth.it]
function AStar(F,t,u,l){function h(c,e){return F[50*e+c]==0}function r(c,e){return{Parent:c,value:e.x+e.y*n,x:e.x,y:e.y,f:0,g:0}}function G(c,e,j,i,g,d,f,a,b){if(c){j&&h(f,g)&&b.push({x:f,y:g});i&&h(a,g)&&b.push({x:a,y:g})}if(e){j&&h(f,d)&&b.push({x:f,y:d});i&&h(a,d)&&b.push({x:a,y:d})}}function H(c,e,j,i,g,d,f,a,b){c=g>-1;e=d<s;j=f<n;i=a>-1;if(j){c&&h(f,g)&&b.push({x:f,y:g});e&&h(f,d)&&b.push({x:f,y:d})}if(i){c&&h(a,g)&&b.push({x:a,y:g});e&&h(a,d)&&b.push({x:a,y:d})}}function v(c,e){return I(o(c.x-e.x),o(c.y-e.y))}function w(c,e){return J(x(c.x-e.x,2)+x(c.y-e.y,2))}function y(c,e){return o(c.x-e.x)+o(c.y-e.y)}var o=Math.abs,I=Math.max,x=Math.pow,J=Math.sqrt,n=50,s=30,z=n*s,A={Diagonal:v,DiagonalFree:v,Euclidean:w,EuclideanFree:w,Manhattan:y}[l]||y;return function(){var c=r(null,{x:t[0],y:t[1]}),e=r(null,{x:u[0],y:u[1]}),j=Array(z);c=[c];for(var i=[],g=[],d,f,a,b,k;f=c.length;){d=z;a=-1;for(b=0;b<f;b++)if(c[b].f<d){d=c[b].f;a=b}f=c.splice(a,1)[0];if(f.value===e.value){a=i[i.push(f)-1];do g.push([a.x,a.y]);while(a=a.Parent);j=i=c=[];g.reverse()}else{b=f.x;d=f.y;a=d-1;k=d+1;var p=b+1,q=b-1,B=a>-1&&h(b,a),C=k<s&&h(b,k),D=p<n&&h(p,d),E=q>-1&&h(q,d),m=[];B&&m.push({x:b,y:a});D&&m.push({x:p,y:d});C&&m.push({x:b,y:k});E&&m.push({x:q,y:d});l(B,C,D,E,a,k,p,q,m);d=m;b=0;for(k=d.length;b<k;b++){a=r(f,d[b]);if(!j[a.value]){a.g=f.g+A(d[b],f);a.f=a.g+A(d[b],e);c.push(a);j[a.value]=true}}i.push(f)}}return g}(function(){switch(l){case "Diagonal":case "Euclidean":l=G;break;case "DiagonalFree":case "EuclideanFree":l=H;break;default:l=function(){}}}())};